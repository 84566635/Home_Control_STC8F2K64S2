C51 COMPILER V9.00   RELAY                                                                 08/27/2018 17:05:12 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE RELAY
OBJECT MODULE PLACED IN ..\Output\relay.obj
COMPILER INVOKED BY: D:\Keil_v514\C51\BIN\C51.EXE ..\User\relay.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(..\L
                    -isting\relay.lst) TABS(2) OBJECT(..\Output\relay.obj)

line level    source

   1          #include "relay.h"
   2          #include "io.h"
   3          
   4          uint8_t Relay_Temp[4] = {0};
   5          uint8_t Relay_State = 0;
   6          
   7                
   8          void Relay_Init(void)
   9          {
  10   1        uint8_t Cnt;
  11   1        for(Cnt = 0;Cnt < 2;Cnt++)
  12   1        {
  13   2          Relay_Control(Cnt,OFF); 
  14   2        }
  15   1      }
  16          
  17          
  18          void Relay_Control(uint8_t Num,uint8_t Set)
  19          {
  20   1         switch(Num)
  21   1         {
  22   2           case 0x00:
  23   2             switch(Set)
  24   2             {
  25   3               case Keep:
  26   3                 break;
  27   3               case OFF:
  28   3                 Relay1 = OFF;
  29   3                 Relay_Temp[Num] = OFF;
  30   3                 break;
  31   3               case ON:
  32   3                 Relay1 = ON;
  33   3                 Relay_Temp[Num] = ON;
  34   3                 break;
  35   3               case Toggle:
  36   3                 if(Relay_Temp[Num])
  37   3                 {
  38   4                   Relay1 = OFF;
  39   4                   Relay_Temp[Num] = OFF;          
  40   4                 }
  41   3                 else
  42   3                 {
  43   4                   Relay1 = ON;
  44   4                   Relay_Temp[Num] = ON;           
  45   4                 }
  46   3                 break;
  47   3                 
  48   3               default:
  49   3                 break;
  50   3             }
  51   2             break;
  52   2           case 0x01:
  53   2             switch(Set)
  54   2             {
C51 COMPILER V9.00   RELAY                                                                 08/27/2018 17:05:12 PAGE 2   

  55   3               case Keep:
  56   3                 break;
  57   3               case OFF:
  58   3                 Relay2 = OFF;
  59   3                 Relay_Temp[Num] = OFF;
  60   3                 break;
  61   3               case ON:
  62   3                 Relay2 = ON;
  63   3                 Relay_Temp[Num] = ON;
  64   3                 break;
  65   3               case Toggle:
  66   3                 if(Relay_Temp[Num])
  67   3                 {
  68   4                   Relay2 = OFF;
  69   4                   Relay_Temp[Num] = OFF;          
  70   4                 }
  71   3                 else
  72   3                 {
  73   4                   Relay2 = ON;
  74   4                   Relay_Temp[Num] = ON;           
  75   4                 }
  76   3                 break;
  77   3                 
  78   3               default:
  79   3                 break;
  80   3             }       
  81   2             break;
  82   2           
  83   2           default:
  84   2             break;  
  85   2         }
  86   1      }
  87          
  88          
  89          
  90          void Cmd_Control_Relay(uint8_t *Cmd)
  91          {
  92   1         switch(Cmd[5])
  93   1         {
  94   2           case 0x01:
  95   2             switch(Cmd[6])
  96   2             {
  97   3               case 0x00:
  98   3                 break;
  99   3               case 0x01:
 100   3                 Relay_Control(0,OFF);
 101   3                 break;    
 102   3               case 0x02:
 103   3                 Relay_Control(0,ON);          
 104   3                 break;
 105   3               case 0x03:
 106   3                 Relay_Control(0,Toggle);
 107   3                 break;        
 108   3               
 109   3               default:
 110   3                 break;      
 111   3             }
 112   2             break;
 113   2             
 114   2            case 0x02:
 115   2               switch(Cmd[6])
 116   2               {
C51 COMPILER V9.00   RELAY                                                                 08/27/2018 17:05:12 PAGE 3   

 117   3                 case 0x00:
 118   3                   break;
 119   3                 case 0x01:
 120   3                   Relay_Control(1,OFF);  
 121   3                   break;           
 122   3                 case 0x02:
 123   3                   Relay_Control(1,ON);
 124   3                   break;          
 125   3                 case 0x03:
 126   3                   Relay_Control(1,Toggle);                
 127   3                   break;
 128   3                 
 129   3                 default:
 130   3                   break;      
 131   3               }        
 132   2              break;
 133   2            
 134   2            default:
 135   2              break; 
 136   2         }
 137   1      }
 138          
 139          void IO_Control_Relay(uint8_t Num)
 140          {
 141   1        if(Num < Device_Mode)
 142   1        {
 143   2          Relay_Control(Num,Toggle);        
 144   2        }
 145   1      }
 146          
 147          void Relay_State_Conver(void)
 148          {
 149   1        Relay_State = (Relay_Temp[0] == 0x01?0x02:0x01)
 150   1                     |(Relay_Temp[1] == 0x01?0x02:0x01)<<2
 151   1                     |(Relay_Temp[2] == 0x01?0x02:0x01)<<4
 152   1                     |(Relay_Temp[3] == 0x01?0x02:0x01)<<6; 
 153   1      }
 154          
 155          
 156          
 157          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    274    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
